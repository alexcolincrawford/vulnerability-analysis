# Vulnerability Management Project with Tenable Nessus

## Objective
Implemented a comprehensive vulnerability management project leveraging Tenable Nessus and Metasploitable within a simulated environment. The project focused on identifying, prioritizing, and mitigating security vulnerabilities to strengthen network security posture.

### Skills Gained
- Proficiency in vulnerability scanning and assessment using Tenable Nessus.
- Experience with vulnerability prioritization based on severity and impact.
- Ability to interpret and analyze vulnerability scan reports to inform remediation strategies.
- Hands-on implementation of security measures through continuous vulnerability monitoring.
- Familiarity with virtualization technologies (VMware) for setting up target environments.

### Tools Used
- Nessus for vulnerability scanning and assessment.
- Metasploitable as a target environment to showcase vulnerabilities and demonstrate exploit scenarios
- VMware Workstation for managing the virtualized environments.
- Linux (Ubuntu) as the host operating system, but another host OS can be used.

## Steps
### Setting Up Metasploitable
1. Download Metasploitable @ https://sourceforge.net/projects/metasploitable/
2. Extract the downloaded ZIP file

<img src="https://github.com/alexcolincrawford/vulnerability-analysis/assets/59071533/fba09fec-4330-4319-8835-c89800d4d0fb" alt="Image" />

3. Import into virtualization software
- As this project uses VMware Workstation, the .VMX can simply be imported.

![image](https://github.com/alexcolincrawford/vulnerability-analysis/assets/59071533/2ea800a3-f235-44e0-8cf1-51352c697af2)

4. Power on the box and login.
- Note: msfadmin is provided for both username and password.

5. Acquire IP address, using `ip a`, to ensure both devices can communicate
- By acquiring the IP address, it will enable us to scan the box for vulnerabilities using nessus later.

![image](https://github.com/alexcolincrawford/vulnerability-analysis/assets/59071533/cbfd47ba-9119-480a-8d82-01ebe3affe5f)

6. Finally, going back to our host machine, where Nessus will be setup, we should ensure the connectivity between the two machines
![image](https://github.com/alexcolincrawford/vulnerability-analysis/assets/59071533/a2d563a6-cde4-4916-8449-d92647fe3ede)

### Setting Up Tenable Nessus

1. Downloading the Tenable Nessus package file
- This is can be done @ https://docs.tenable.com/nessus/Content/InstallNessusLinux.htm#Download-the-Tenable-Nessus-package-file.

2. Verify The Hashes Match For Integrity
  - To ensure integrity, we should compute a hash and compare, as shown below.
![image](https://github.com/alexcolincrawford/vulnerability-analysis/assets/59071533/6cae31f9-779b-44e3-a400-925ddc156c15)
![image](https://github.com/alexcolincrawford/vulnerability-analysis/assets/59071533/00d13018-bf67-4d3c-8579-376fb0e556de)

4. Installing the Tenable Nessus package file
- Next, the package file can be installed, as shown below.

![image](https://github.com/alexcolincrawford/vulnerability-analysis/assets/59071533/4d4ed238-484c-455f-b8cf-e938e56935a8)

5. Starting The Service & Accessing Nessus Dashboard
- First the `nessusd.service` must be started, then, by going to typing in localhost and port 8834, we can get into the Nessus Dashboard

![image](https://github.com/alexcolincrawford/vulnerability-analysis/assets/59071533/ab071c5c-fdcf-4ea8-9637-0643f33ddb4e)

6. Register an account to Nessus Essentials
- Select Nessus Essentials, the free version, and create an account.

### Scanning The Metasploitable Machine via Nessus
- Note: There are many ways to configure a scan; this project shows one of the many configurations.
1. Select _Basic Network Scan_

![image](https://github.com/alexcolincrawford/vulnerability-analysis/assets/59071533/33aad93b-89c6-4bdf-b41f-9db324e96ad0)

2. Configuring Settings
- Make sure to include the IP address of the metasploitable machine in targets, as demonstrated below.

![image](https://github.com/alexcolincrawford/vulnerability-analysis/assets/59071533/3034ac91-5477-4f24-8941-663ccab422f0)

- Instead of most common ports, instead scan all ports.

![image](https://github.com/alexcolincrawford/vulnerability-analysis/assets/59071533/dd968601-369c-41af-b409-2a25570290df)

- Enable web application scanning!

![image](https://github.com/alexcolincrawford/vulnerability-analysis/assets/59071533/a3a23ec2-6ec6-42fe-ae6e-658ce0486dca)

3. Start Scan
- Save the configuration, start it, as shown, then wait for the results...

![image](https://github.com/alexcolincrawford/vulnerability-analysis/assets/59071533/2afe2674-86ee-4c7a-a9ed-9d3e5ccc5bf8)

### Interpreting Scan Results

![image](https://github.com/alexcolincrawford/vulnerability-analysis/assets/59071533/b5b6b1bf-4f07-4ec6-a49d-eac501a1442a)

- By examining the report generated by nessus, the vulnerabilities are detailed using CVSS-based severity.
- A risk-based approach has been employed as means to priorize the remediation of vulnerabilities, where the priority of vulnerabilities goes: critical (CVSS score 9.0 - 10.0) have most priority, high (CVSS score 7.0 - 8.9) second and so on.

### Remediation
- Note: Due to massive scope of vulnerabilities associated with the target, for demonstration purposes, only some of the high priority vulnerabilties will be detailed.

![image](https://github.com/alexcolincrawford/vulnerability-analysis/assets/59071533/b5611ed7-700b-4741-89da-79d89435ce02)

**NFS Exported Share Information Disclosure (CVSS 10.0)**
- By default, the ACL, allows all hosts to mount all directories from the NFS.
- This can be remediated by specifically allowing chosen hosts, as shown below.

![image](https://github.com/alexcolincrawford/vulnerability-analysis/assets/59071533/4c608915-f9b9-4547-a537-c6697d7debcc)

- Example of denied client below:

![image](https://github.com/alexcolincrawford/vulnerability-analysis/assets/59071533/67eb1389-8a06-4bd2-a8f5-71997bd814a5)
- If a client would more devices to be able to access the NFS, they can be appended into the exports file.
