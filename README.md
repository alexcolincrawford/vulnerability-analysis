# Vulnerability Management Project with Tenable Nessus

## Objective
Implemented a comprehensive vulnerability management project leveraging Tenable Nessus and Metasploitable within a simulated environment. The project focused on identifying, prioritizing, and mitigating security vulnerabilities to strengthen network security posture.

### Skills Gained
- Proficiency in vulnerability scanning and assessment using Tenable Nessus.
- Experience with vulnerability prioritization based on severity and impact.
- Ability to interpret and analyze vulnerability scan reports to inform remediation strategies.
- Hands-on implementation of security measures through continuous vulnerability monitoring.
- Familiarity with virtualization technologies (VMware) for setting up target environments.

### Tools Used
- Nessus for vulnerability scanning and assessment.
- Metasploitable as a target environment to showcase vulnerabilities and demonstrate exploit scenarios
- VMware Workstation for managing the virtualized environments.
- Linux (Ubuntu) as the host operating system, but another host OS can be used.

## Steps

### Setting Up Metasploitable

1. **Download Metasploitable:**
   - Download Metasploitable from [SourceForge](https://sourceforge.net/projects/metasploitable/).

2. **Extract the Downloaded ZIP file:**
   - Extract the downloaded ZIP file to access the virtual machine (VM) files.
   
   ![Metasploitable](https://github.com/alexcolincrawford/vulnerability-analysis/assets/59071533/fba09fec-4330-4319-8835-c89800d4d0fb)

3. **Import into Virtualization Software:**
   - Import the extracted files into your virtualization software (e.g., VMware Workstation) by opening the `.VMX` file.

   ![Import Metasploitable](https://github.com/alexcolincrawford/vulnerability-analysis/assets/59071533/2ea800a3-f235-44e0-8cf1-51352c697af2)

4. **Power On the VM and Login:**
   - Power on the Metasploitable VM and log in using the default credentials (`msfadmin` for both username and password).

5. **Acquire IP Address:**
   - On the Metasploitable VM, use the command `ip a` to identify its IP address & Ensure connectivity between the host and Metasploitable VM. E.g. via ping

   ![Metasploitable IP Address](https://github.com/alexcolincrawford/vulnerability-analysis/assets/59071533/cbfd47ba-9119-480a-8d82-01ebe3affe5f)

### Setting Up Tenable Nessus

1. **Download the Tenable Nessus Package:**
   - Download the Tenable Nessus package file from the [official documentation](https://docs.tenable.com/nessus/Content/InstallNessusLinux.htm#Download-the-Tenable-Nessus-package-file).

2. **Verify Hashes for Integrity:**
   - Compute the hash of the downloaded package file and verify its integrity against the provided hash values.

   ![Verify Hashes](https://github.com/alexcolincrawford/vulnerability-analysis/assets/59071533/6cae31f9-779b-44e3-a400-925ddc156c15)
   ![Hash Comparison](https://github.com/alexcolincrawford/vulnerability-analysis/assets/59071533/00d13018-bf67-4d3c-8579-376fb0e556de)

3. **Install the Tenable Nessus Package:**
   - Install the Nessus package file on your host system following the installation instructions.

   ![Install Nessus](https://github.com/alexcolincrawford/vulnerability-analysis/assets/59071533/4d4ed238-484c-455f-b8cf-e938e56935a8)

4. **Start the Nessus Service & Access the Dashboard:**
   - Start the `nessusd.service` and access the Nessus Dashboard by navigating to `localhost:8834` in a web browser.

   ![Nessus Dashboard](https://github.com/alexcolincrawford/vulnerability-analysis/assets/59071533/ab071c5c-fdcf-4ea8-9637-0643f33ddb4e)

5. **Register an Account for Nessus Essentials:**
   - Register for Nessus Essentials (free version) by creating a new account on the Nessus Dashboard.

### Scanning the Metasploitable Machine via Nessus

1. **Configure a Basic Network Scan:**
   - Set up a basic network scan in Nessus by selecting appropriate scan settings.

   ![Network Scan Configuration](https://github.com/alexcolincrawford/vulnerability-analysis/assets/59071533/33aad93b-89c6-4bdf-b41f-9db324e96ad0)

2. **Specify Scan Targets:**
   - Configure the scan to target the IP address of the Metasploitable machine and scan all ports for comprehensive vulnerability detection.

   ![Specify Scan Targets](https://github.com/alexcolincrawford/vulnerability-analysis/assets/59071533/3034ac91-5477-4f24-8941-663ccab422f0)
   ![Scan All Ports](https://github.com/alexcolincrawford/vulnerability-analysis/assets/59071533/dd968601-369c-41af-b409-2a25570290df)

3. **Enable Web Application Scanning:**
   - Optionally enable web application scanning if applicable.

   ![Web Application Scanning](https://github.com/alexcolincrawford/vulnerability-analysis/assets/59071533/a3a23ec2-6ec6-42fe-ae6e-658ce0486dca)

4. **Start the Scan:**
   - Save the scan configuration and start the scan. Wait for the scan to complete.

   ![Start Scan](https://github.com/alexcolincrawford/vulnerability-analysis/assets/59071533/2afe2674-86ee-4c7a-a9ed-9d3e5ccc5bf8)

### Interpreting Scan Results

- Analyze the vulnerability scan report generated by Nessus, focusing on CVSS-based severity ratings to prioritize remediation efforts.

   ![Scan Results](https://github.com/alexcolincrawford/vulnerability-analysis/assets/59071533/b5b6b1bf-4f07-4ec6-a49d-eac501a1442a)

### Remediation

1. **NFS Exported Share Information Disclosure (CVSS 10.0):**
   - Modify NFS export configurations to restrict access only to authorized hosts.

   ![NFS Remediation](https://github.com/alexcolincrawford/vulnerability-analysis/assets/59071533/4c608915-f9b9-4547-a537-c6697d7debcc)

2. **Bind Shell Backdoor Detection (CVSS 9.8 - 10.0):**
   - Implement firewall rules to block incoming traffic on specific ports (e.g., 1524) to prevent unauthorized access.

   ![Bind Shell Remediation](https://github.com/alexcolincrawford/vulnerability-analysis/assets/59071533/b2c585d1-65f1-4183-bad7-7826f28e11b0)

3. **SSL Version 2 & 3 Protocol Detection (CVSS 9.8):**
   - Update SSL configurations to use TLS 1.2 or higher for secure communications.

   ![SSL/TLS Remediation](https://github.com/alexcolincrawford/vulnerability-analysis/assets/59071533/6679ed67-318e-4ec4-b64c-5d8a4fd6ea04)

### Rescan to Verify Mitigations

- Conduct a follow-up scan using Nessus to verify that the implemented mitigations have successfully remediated the identified vulnerabilities.

   ![Rescan Results](https://github.com/alexcolincrawford/vulnerability-analysis/assets/590715


- As shown in the provided image, _NFS Exported Share Information Disclosure_ & _Bind Shell Backdoor Detection_ have not been flagged this time.
- Note: SSL Version 2 & 3 Protocol Detection is flagged as this project only remediated this vulnerability for _postgressql_ and has been flagged for **SMTP ONLY** as proven below.

![image](https://github.com/alexcolincrawford/vulnerability-analysis/assets/59071533/8642f5a1-040a-4548-aa71-c01c938fbdc9)


### Conclusion & Takeaways
Implementing a vulnerability management project with Tenable Nessus and Metasploitable provides valuable insights into securing networks against cyber threats.

Key Takeways: 
- **Risk Prioritization**: Focus on critical vulnerabilities (CVSS score 9.0 - 10.0) for immediate remediation.
- **Collaborative Security Efforts**: Simulated environments enable testing of remediation strategies.
- **Hands On Experience**: By conducting this project, I have gained hands on experience of simulating a vulnerability assessment and providing effective mitigation strategies.
